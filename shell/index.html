<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    
    
    <!-- google site -->
    <meta name="google-site-verification" content="BazmSJ55LY7H3RD6ttelAsE8PmOPjhkFnDdIjFMCiJE" />
    <title>neo1218の死宅 - POST</title>
    <link rel="shortcut icon" href="http://7xj431.com1.z0.glb.clouddn.com/cropped-150-150-688417.png" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href=/static/css/base_site.css>
    <link rel="stylesheet" type="text/css" href=/static/css/index.css>
    <link rel="stylesheet" type="text/css" href=/static/css/post.css>
    <link rel="stylesheet" type="text/css" href=/static/css/self_card.css>
    <link rel="stylesheet" type="text/css" href=/static/css/logo/github.css>
    <link rel="stylesheet" type="text/css" href=/static/css/logo/facebook.css>
    <link rel="stylesheet" type="text/css" href=/static/css/logo/twitter.css>
    <link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/pygments.css">
    <link href=/static/image/bg.png>
</head>
<body>
<header>
    <div class="top-z-container">
        <!--blur-->
        <div class="blur-top-image"></div>
        <div id="top-bar">
            <nav class="left-box">
                <ul>
                    <li>
                        <a href=/>neo1218の死宅</a> - Pythoner 死宅到底 不想说话 木犀万岁!
                    </li>
                </ul>
            </nav>
        </div>
    </div>
    <div id="top-image"></div>
    <nav class="nav-wrapper">
        <ul class="category-list">
            <li>
                <a href=/>
                    <span>首页</span>
                    <div class="menu-icon-wrapper">
                        <span class="menu-icon icon-no-bg-color fa fa-home"></span>
                    </div>
                </a>
            </li>
            
                <li onmouseover="show_menu(this)" onmouseout="hide_menu(this)">
                    <a href=/tag/Web/>
                        <div class="menu-icon-wrapper">
                            <span class="menu-icon">7</span>
                        </div>
                        Web
                    </a>
                    <ul class="drop-down" align="center">
                        <span>Web开发</span>
                    </ul>
                </li>
            
                <li onmouseover="show_menu(this)" onmouseout="hide_menu(this)">
                    <a href=/tag/Life/>
                        <div class="menu-icon-wrapper">
                            <span class="menu-icon">2</span>
                        </div>
                        Life
                    </a>
                    <ul class="drop-down" align="center">
                        <span>生活随笔</span>
                    </ul>
                </li>
            
                <li onmouseover="show_menu(this)" onmouseout="hide_menu(this)">
                    <a href=/tag/Python/>
                        <div class="menu-icon-wrapper">
                            <span class="menu-icon">15</span>
                        </div>
                        Python
                    </a>
                    <ul class="drop-down" align="center">
                        <span>Python学习</span>
                    </ul>
                </li>
            
                <li onmouseover="show_menu(this)" onmouseout="hide_menu(this)">
                    <a href=/tag/Other/>
                        <div class="menu-icon-wrapper">
                            <span class="menu-icon">3</span>
                        </div>
                        Other
                    </a>
                    <ul class="drop-down" align="center">
                        <span>其他</span>
                    </ul>
                </li>
            
                <li onmouseover="show_menu(this)" onmouseout="hide_menu(this)">
                    <a href=/tag/DIY/>
                        <div class="menu-icon-wrapper">
                            <span class="menu-icon">4</span>
                        </div>
                        DIY
                    </a>
                    <ul class="drop-down" align="center">
                        <span>个人项目</span>
                    </ul>
                </li>
            
                <li onmouseover="show_menu(this)" onmouseout="hide_menu(this)">
                    <a href=/tag/OS/>
                        <div class="menu-icon-wrapper">
                            <span class="menu-icon">5</span>
                        </div>
                        OS
                    </a>
                    <ul class="drop-down" align="center">
                        <span>操作系统学习</span>
                    </ul>
                </li>
            
                <li onmouseover="show_menu(this)" onmouseout="hide_menu(this)">
                    <a href=/tag/Algo/>
                        <div class="menu-icon-wrapper">
                            <span class="menu-icon">7</span>
                        </div>
                        Algo
                    </a>
                    <ul class="drop-down" align="center">
                        <span>算法学习</span>
                    </ul>
                </li>
            
            <li>
                <a href=/about/>
                    <span>关于</span>
                    <div class="menu-icon-wrapper">
                        <span class="menu-icon icon-no-bg-color fa fa-info"></span>
                    </div>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main>
    <div id="main">
        
<div class="post-body-wrapper">
    <div class="main_post">
        <h1>常见的shell需求总结</h1>
        <h3>2016-06-19 10:32:34</h3>
        <div class="post_body">
            <h1 id="shell">常见shell需求总结</h1>

<p>这两天把自己的一个Python项目用shell改写, 这里记录项目中遇到的一些基本需求</p>

<h2 id="1-shell">1. shell 函数</h2>

<pre><code>function func_name()
{
    func_body
}

func_name  # 调用
</code></pre>

<p>function 关键字可以省略 <br/><br />
<strong>函数接受参数</strong> <br/></p>

<pre><code>function hello()
{
    echo "Hello $1"
}

hello "neo1218"  # 调用
</code></pre>

<p>$0 代表函数本身, $1-9 依顺序代表参数, 10个以上需要 ${10} 调用。<br/><br />
函数的返回值只能是0~255<br />
<br/><br />
<strong>常用函数</strong> <br/><br />
1. <strong><em>log 函数</em></strong> <br/></p>

<pre><code>function log()
{
    printf " \033[36m%10s\033[0m: \033[90m%s\033[0m\n" $1 $2
}
</code></pre>

<p>这里和Linux终端特殊颜色字符使用, 使log更&rdquo;好看&rdquo; <br/><br />
2. <strong><em>error_exit 函数</em></strong> <br/></p>

<pre><code>function error_exit()
{
    echo $ 2&gt;&amp;1
    exit 1
}
</code></pre>

<p>exit 表示退出状态, exit 0 表示成功退出, 非0表示异常退出.<br/><br />
这里还有一个很有意思的地方: 2&gt;&amp;1 <br/><br />
这里的1是<code>stdout</code> , 2是<code>stderr</code>, 2&gt;&amp;1 就是将标准错误重定向到标准输出,<br />
用于错误处理。 <br/><br />
3. <strong><em>help 系列函数</em></strong> <br/><br />
即显示信息的函数<br/></p>

<pre><code>function display_msg()
{
    cat &lt;&lt;-EOF
    msg msg msg
    msg msg msg
EOF
}
</code></pre>

<p>这样就可以很好的在终端显示信息啦 <br/><br />
4. <strong><em>其他</em></strong> </br><br />
shell函数还有一个很有意思的特性, 关于shell的作用域,<br />
即函数中可以直接对全局变量进行修改, 这样就可以很方便的在不同函数中调用全局状态,<br />
对于简单的面向过程程序是非常友好的。<br/><br />
当然也可以在函数中定义局部变量<code>local lvar</code></p>

<h2 id="2-shell">2. shell数组</h2>

<p>shell支持数组的使用, 但是索引是从1开始&hellip;<br/><br />
1. <strong>定义数组</strong> <br/><br />
array=()<br />
<br/><br />
2. <strong>取数组元素值</strong> <br/><br />
array[4]<br />
<br/><br />
3. <strong>获取数组的长度</strong> <br/><br />
${#array[@]}<br />
<br/><br />
4. <strong>获取数组最后一个元素</strong> <br/><br />
${array[${#array[@]}]}<br />
<br/></p>

<h2 id="3-shell">3. shell 判断</h2>

<p>shell支持一系列的判断 <br/><br />
1. <strong>判断路径是否存在</strong> <br/><br />
<code>if test -d "$path"</code><br />
<br/><br />
2. <strong>判断字符串是否为空</strong> <br/><br />
<code>if test -z $string</code><br />
<br/><br />
3. <strong>判断是否存在参数</strong> <br/><br />
<code>if test $# -eq 0</code></p>

<h2 id="4-case">4. case 语句</h2>

<p>shell 支持case语句 </br></p>

<pre><code>case $var in
    xxx)  do sth ;;
    xx|xxx) do sth ;;
esac
</code></pre>

<h2 id="5">5. 处理用户参数</h2>

<p>由于c是命令, 所以处理用户参数就是必须的, 这里给个总结模版</p>

<pre><code>if test $# -eq 0; then
    do sth
else
    while test $# -ne 0; do
        case $args in
            case1)
                do sth ;;
            -h|--help)
                display_help ;;
            -v|--version)
                show_version ;;
        esac
        shift
    done
fi
</code></pre>

<h2 id="6">6. 其他</h2>

<ol>
<li><strong>$?</strong> 用于获取最近的返回值 <br/></li>
<li><strong>赋值变量与被赋值变量中间的等号不含空格</strong> <br/></li>
</ol>

<h2 id="_1">总结</h2>

<p>从python到shell, 是想挑战一下, 而且shell的速度快,<br />
直接shell执行。像这种命令式面向过程的程序是很适合用shell编写的。</p>

        </div>
    </div>
    <div id="disqus_thread" style="padding: 50px"></div>
    <script>
    /**
    * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    
    s.src = '//neo1218flask.disqus.com/embed.js';
    
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>

    </div>
</main>
<footer>
    <div id="foot">
        
            <div class="footer">
                <span>
                    Powered by:
                    <a href="https://github.com/neo1218/railgun/" target="_blank">railgun</a>
                    I am a loser
                </span>
                <br>
            </div>
        
    </div>
</footer>
<a href="#" id="toTop" style="top: 0px;" onclick="scroll_to_top(0.9); return false;">
    <div id="toTopRope"></div>
    <img id="toTopHover" src="http://7xj431.com1.z0.glb.clouddn.com/topscroll.png"></div>
</a>
</body>
    <script src=/static/js/base_site.js> </script>
    <script src=/static/js/disqus/embed.js></script>
</html>